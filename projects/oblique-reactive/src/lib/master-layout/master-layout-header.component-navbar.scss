@import '~bootstrap/scss/functions';
@import "~bootstrap/scss/variables";
@import "../../styles/scss/core/variables";
@import "../../styles/scss/core/mixins/animation";
@import "../../styles/scss/core/mixins/bubble-tail";
@import "../../styles/scss/core/mixins/layout";

.application-header {
	.navbar {
		display: block;
		z-index: 1;
		width: 100%;
		padding: 0;
		background-color: inherit;
		border-bottom: $brand-line-width solid $brand-danger;

		@include layout-collapse-up() {
			display: flex;
			flex-direction: row;
		}

		@include layout-collapse-down() {
			overflow: hidden;
			height: $header-height-collapsed;
			@include animatable(height);

			.header-open & {
				height: $header-height-md;
			}
		}

		.navbar-header {
			display: flex;
			flex: 1;
			flex-direction: row;
			flex-wrap: nowrap;
			margin-right: auto; // Ensure controls get pushed to the right
			min-width: 0; // Important, for text ellipsis of app title (cf. https://css-tricks.com/flexbox-truncated-text/)!
		}

		.navbar-controls.navbar-nav {
			display: inline-flex;
			flex-direction: row;
			align-items: center;
			min-height: inherit;
			margin: 0;
			padding: 0;

			.nav-item {
				.control-link:hover,
				.control-link:active,
				.control-link:focus,
				&:active .control-link,
				&:focus .control-link,
				&.active .control-link,
				&.open .control-link,
				&.show .control-link {
					color: $brand-default;
				}

				&:active .control-link,
				&:focus .control-link,
				&.active .control-link {
					.control-label {
						&::before {
							opacity: 1;
						}
					}
				}

				> .tooltip,
				> .control-link > .tooltip {
					white-space: nowrap;

					&.top {
						margin-top: 14px;
					}

					&.bottom {
						margin-top: -4px;
					}
				}

				.dropdown-item.active,
				.dropdown-item:active {
					background-color: #f8f9fa;
					color: $brand-default;
				}

				.dropdown {
					@include layout-collapse-down() {
						&.show {
							@include bubble-tail-border(
									$brand-danger,
									$brand-danger,
								$width: 8px,
								$align: left,
								$align-value: 18px,
								$placement: bottom,
								$direction: top
							);
						}
					}

					.dropdown-menu {
						border-radius: 0;

						@include layout-collapse-down() {
							position: fixed !important;
							top: $header-height-md !important;
							left: 0;
							right: 0;
							bottom: 0;
							padding: $spacing-default;
							margin: 0;
							transform: none !important;
							height: 100%;
							overflow-y: auto;

							.nav-link {
								margin-bottom: 0;
								text-overflow: ellipsis;
								white-space: nowrap;
								padding-top: 13px;
								padding-bottom: 13px;
							}
						}

						@include layout-collapse-up() {
							position: absolute;
							left: $spacing-default !important;
							top: $spacing-default !important;
							min-width: 260px;
							padding: $spacing-default;
							margin-top: -2px;
							max-height: calc(100vh - #{$header-height});

							@include bubble-tail-border(
									$dropdown-bg,
									$dropdown-border-color,
								$align: right,
								$align-value: 14px,
								$position: absolute
							);
						}
					}

					.dropdown-toggle::after {
						display: none;
					}
				}

				@include layout-collapse-down() {
					// Don't display control tooltips on small viewports:
					> .tooltip,
					> .control-link > .tooltip {
						display: none !important;
					}
				}
			}

			@include layout-collapse-up() {
				justify-content: flex-end;

				@at-root :not(.application-fixed) #{selector-append(".application-header-animate", &)} {
					@include animatable(margin-top);
				}
			}

			.control-link {
				@include animatable();
				display: block;
				padding: $spacing-default;
				color: $gray-dark;

				.control-toggle,
				.control-icon,
				.control-label {
					margin: 0;
					vertical-align: middle;
				}

				.control-icon + .control-label,
				.control-toggle + .control-label,
				.control-label + .control-icon {
					margin-left: $spacing-xs;
				}

				.control-toggle {
					font-weight: normal;
				}

				.control-icon {
					cursor: pointer;
					font-size: $font-size-xl;
				}

				.control-label {
					cursor: pointer;

					&::before {
						opacity: 0.6;
					}
				}

				.nav-link {
					color: inherit;
					padding: 0;
				}
			}
		}
	}
}
