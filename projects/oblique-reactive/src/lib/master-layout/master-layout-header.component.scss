@import '~bootstrap/scss/functions';
@import "~bootstrap/scss/variables";
@import "../../styles/scss/core/variables";
@import "../../styles/scss/core/mixins/animation";
@import "../../styles/scss/core/mixins/bubble-tail";
@import "../../styles/scss/core/mixins/layout";

.application-header {
	position: relative;
	background-color: $white;
	background-clip: content-box;
	z-index: 10;
	@include animatable(height, $duration: $duration-default);

	.application:not(.application-fixed) &.application-header-sticky {
		@include layout-fixed-top();
		z-index: $zindex-dropdown + 2;
	}

	@include layout-collapse-down() {
		@include layout-fixed-top();
		overflow: hidden;
		display: flex;
		flex-direction: column;
		width: 100%;
		height: $header-height-collapsed;

		.header-open & {
			height: 100%;
		}

		.header-open.no-navigation & {
			height: $header-height-md;
		}
	}

	@include layout-collapse-up() {
		height: $header-height;

		&.application-header-md {
			height: $header-height-md;
		}

		&.application-header-animate {
			padding: 0;
			margin: 0;
		}

		.application.no-navigation & {
			height: $header-height-no-navigation;

			&.application-header-md {
				height: $header-height-no-navigation - ($header-height - $header-height-md);
			}
		}

		.application-fixed & {
			flex-shrink: 0;
		}
	}

	.application-brand {
		display: flex;
		flex: auto;
		flex-direction: row;
		align-items: center;
		min-width: 0; // Important, for text ellipsis of app title (cf. https://css-tricks.com/flexbox-truncated-text/)!
		padding: 8px $spacing-default;
		@include animatable(padding);

		@include layout-collapse-up() {
			@at-root #{selector-append(":not(.application-header-md)", &)} {
				padding: $spacing-default;
			}
		}
	}

	.application-brand-logo {
		float: left; // IE7+ fix
		overflow: hidden;
		width: $brand-logo-width-collapsed;
		height: $brand-logo-height-collapsed;
		margin-right: $spacing-default;

		@include layout-collapse-up() {
			@at-root #{selector-append(":not(.application-header-md)", &)} {
				width: $brand-logo-width;
				height: $brand-logo-height;
				margin-top: 0;
			}
		}

		img {
			width: $brand-logo-width;
			height: $brand-logo-height;
		}
	}

	.application-brand-app-title {
		display: block;
		flex: 1;
		font-size: $font-size-xl;
		font-weight: 300;
		padding-left: $spacing-default;
		border-left: 1px solid $gray-lighter;
		max-height: $brand-logo-height-collapsed;
		overflow: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;

		@include layout-collapse-up() {
			@at-root #{selector-append(":not(.application-header-md)", &)} {
				font-size: $font-size-xl;
				max-height: $brand-logo-height;
			}
		}

		.application-brand-link {
			color: $brand-default;
			text-decoration: none;
		}
	}


	.navbar-toggler {
		border: none;

		@include layout-collapse-down() {
			flex-wrap: nowrap;
		}

		@include layout-collapse-up() {
			display: none !important;
		}
	}

	:not(.application-fixed) &.application-header-animate {
		.application-brand-logo, .application-brand-app-title {
			@include animatable();
		}
	}

	.application-header-controls {
		display: flex;
		align-items: center;
		@include layout-collapse-down() {
			visibility: hidden; // Avoids keyboard navigation when collapsed
			transition: visibility $duration-default; // Ensure element keeps visible when header is closing

			.header-open & {
				visibility: visible; // Restores keyboard navigation
			}
		}

		.navbar-locale {
			margin-right: 1rem;

			.btn-link {
				border: none;
				border-radius: 0;
				color: $brand-default;

				&:hover,
				&.active {
					background-color: $gray-lighter-2;
					box-shadow: none;
				}
			}
		}
	}

	@include layout-collapse-down() {
		.application-header-toggler {
			position: relative;

			.first-line,
			.second-line,
			.third-line {
				display: block;
				width: 25px;
				height: 4px;
				background-color: $gray-dark;
				background-clip: border-box;
				border-radius: 2px;
				transition: .25s transform, .15s opacity, .25s border-color;
			}

			&:focus,
			&:active,
			&:hover {
				.first-line,
				.second-line,
				.third-line {
					background-color: $brand-default;
				}
			}

			.first-line {
				margin-bottom: 5px;

				.header-open & {
					transform: rotate(45deg) translate(8px, 5px) scale(1.1);
				}
			}

			.second-line {
				.header-open & {
					opacity: 0;
					transform: scale(0);
				}
			}

			.third-line {
				margin-top: 5px;

				.header-open & {
					transform: rotate(-45deg) translate(8px, -5px) scale(1.1);
				}
			}
		}
	}
}
